"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[5023],{5851:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"getting-started/USDT_ACQUISITION_GUIDE","title":"\ud83d\udcb0 USDT Acquisition Guide","description":"Question: Who puts USDT into the user\'s token account before they can deposit it into the vault?","source":"@site/docs/getting-started/USDT_ACQUISITION_GUIDE.md","sourceDirName":"getting-started","slug":"/getting-started/USDT_ACQUISITION_GUIDE","permalink":"/GoQuant-Project/docs/getting-started/USDT_ACQUISITION_GUIDE","draft":false,"unlisted":false,"editUrl":"https://github.com/sahilgoswami0901/GoQuant-Project/tree/main/docs/getting-started/USDT_ACQUISITION_GUIDE.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Understanding Program ID vs Deployer Wallet","permalink":"/GoQuant-Project/docs/getting-started/PROGRAM_ID_EXPLANATION"},"next":{"title":"How to Add Authorized Programs","permalink":"/GoQuant-Project/docs/others/ADD_AUTHORIZED_PROGRAMS_GUIDE"}}');var r=t(4848),o=t(8453);const i={},l="\ud83d\udcb0 USDT Acquisition Guide",a={},c=[{value:"\ud83d\udd04 Complete Deposit Flow",id:"-complete-deposit-flow",level:2},{value:"\ud83d\udccd Where USDT Comes From",id:"-where-usdt-comes-from",level:2},{value:"Option 1: Buy USDT on a DEX (Decentralized Exchange)",id:"option-1-buy-usdt-on-a-dex-decentralized-exchange",level:3},{value:"Option 2: Receive USDT from Another User",id:"option-2-receive-usdt-from-another-user",level:3},{value:"Option 3: Bridge from Another Chain",id:"option-3-bridge-from-another-chain",level:3},{value:"Option 4: Testing Only - Mint Test USDT",id:"option-4-testing-only---mint-test-usdt",level:3},{value:"\ud83c\udfd7\ufe0f Architecture: Why Users Need USDT First",id:"\ufe0f-architecture-why-users-need-usdt-first",level:2},{value:"Your Vault System&#39;s Role",id:"your-vault-systems-role",level:3},{value:"Token Account Creation",id:"token-account-creation",level:3},{value:"\ud83d\udca1 Integration Options for Your System",id:"-integration-options-for-your-system",level:2},{value:"Option A: Let Users Handle It (Current Approach)",id:"option-a-let-users-handle-it-current-approach",level:3},{value:"Option B: Add DEX Integration (Advanced)",id:"option-b-add-dex-integration-advanced",level:3},{value:"Option C: Provide Test USDT Faucet (Devnet Only)",id:"option-c-provide-test-usdt-faucet-devnet-only",level:3},{value:"\ud83d\udcdd Current Implementation Details",id:"-current-implementation-details",level:2},{value:"Deposit Endpoint Flow",id:"deposit-endpoint-flow",level:3},{value:"Smart Contract Validation",id:"smart-contract-validation",level:3},{value:"\ud83c\udfaf Recommended User Flow",id:"-recommended-user-flow",level:2},{value:"For Your Frontend/UI:",id:"for-your-frontendui",level:3},{value:"Example Frontend Code:",id:"example-frontend-code",level:3},{value:"\ud83d\udd0d Checking User&#39;s USDT Balance",id:"-checking-users-usdt-balance",level:2},{value:"Using Your Backend API:",id:"using-your-backend-api",level:3},{value:"Using Solana RPC Directly:",id:"using-solana-rpc-directly",level:3},{value:"\ud83d\udcda Summary",id:"-summary",level:2},{value:"\ud83d\ude80 Next Steps",id:"-next-steps",level:2},{value:"\ud83d\udd17 Useful Links",id:"-useful-links",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"-usdt-acquisition-guide",children:"\ud83d\udcb0 USDT Acquisition Guide"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Question:"})," Who puts USDT into the user's token account before they can deposit it into the vault?"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Answer:"})," ",(0,r.jsx)(e.strong,{children:"The user themselves"})," must acquire USDT before depositing. The vault system does NOT provide USDT - it only manages deposits and withdrawals of USDT that users already own."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-complete-deposit-flow",children:"\ud83d\udd04 Complete Deposit Flow"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    DEPOSIT FLOW                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nStep 1: User Acquires USDT\n    \u2502\n    \u251c\u2500 Option A: Buy USDT on DEX (Jupiter, Raydium, Orca)\n    \u251c\u2500 Option B: Receive USDT from another user\n    \u251c\u2500 Option C: Bridge USDT from another blockchain\n    \u2514\u2500 Option D: (Testing only) Mint test USDT\n    \u2502\n    \u2193\n    User\'s Token Account now has USDT \u2705\n    \u2502\n    \u2193\nStep 2: User Calls Deposit Endpoint\n    \u2502\n    POST /vault/deposit\n    {\n      "userPubkey": "...",\n      "amount": 100000000  // 100 USDT\n    }\n    \u2502\n    \u2193\nStep 3: Backend Builds Transaction\n    \u2502\n    Transfers USDT from:\n    - user_token_account (source)\n    - vault_token_account (destination)\n    \u2502\n    \u2193\nStep 4: User Signs & Submits Transaction\n    \u2502\n    \u2193\nStep 5: USDT Moves to Vault \u2705\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-where-usdt-comes-from",children:"\ud83d\udccd Where USDT Comes From"}),"\n",(0,r.jsx)(e.h3,{id:"option-1-buy-usdt-on-a-dex-decentralized-exchange",children:"Option 1: Buy USDT on a DEX (Decentralized Exchange)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Most common method for users:"})}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Jupiter Aggregator"})," (Recommended)"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Best rates by aggregating multiple DEXs"}),"\n",(0,r.jsxs)(e.li,{children:["Website: ",(0,r.jsx)(e.a,{href:"https://jup.ag/",children:"https://jup.ag/"})]}),"\n",(0,r.jsx)(e.li,{children:"Swap SOL \u2192 USDT"}),"\n",(0,r.jsx)(e.li,{children:"Automatically creates token account if needed"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Raydium"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Direct DEX on Solana"}),"\n",(0,r.jsxs)(e.li,{children:["Website: ",(0,r.jsx)(e.a,{href:"https://raydium.io/",children:"https://raydium.io/"})]}),"\n",(0,r.jsx)(e.li,{children:"Swap SOL \u2192 USDT"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Orca"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Another popular Solana DEX"}),"\n",(0,r.jsxs)(e.li,{children:["Website: ",(0,r.jsx)(e.a,{href:"https://www.orca.so/",children:"https://www.orca.so/"})]}),"\n",(0,r.jsx)(e.li,{children:"Swap SOL \u2192 USDT"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"How it works:"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"User Wallet (SOL) \u2192 DEX Swap \u2192 User Token Account (USDT)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"option-2-receive-usdt-from-another-user",children:"Option 2: Receive USDT from Another User"}),"\n",(0,r.jsx)(e.p,{children:"Users can send USDT to each other using standard SPL Token transfers:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// Example: User A sends USDT to User B\nimport { transfer } from \"@solana/spl-token\";\n\nawait transfer(\n  connection,\n  payer,              // User A (signer)\n  sourceTokenAccount, // User A's USDT token account\n  destinationTokenAccount, // User B's USDT token account\n  owner,              // User A (authority)\n  100000000           // 100 USDT\n);\n"})}),"\n",(0,r.jsx)(e.h3,{id:"option-3-bridge-from-another-chain",children:"Option 3: Bridge from Another Chain"}),"\n",(0,r.jsx)(e.p,{children:"Users can bridge USDT from Ethereum, BSC, or other chains:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Wormhole"}),": ",(0,r.jsx)(e.a,{href:"https://wormhole.com/",children:"https://wormhole.com/"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Portal (Wormhole UI)"}),": ",(0,r.jsx)(e.a,{href:"https://portalbridge.com/",children:"https://portalbridge.com/"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Allbridge"}),": ",(0,r.jsx)(e.a,{href:"https://allbridge.io/",children:"https://allbridge.io/"})]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"option-4-testing-only---mint-test-usdt",children:"Option 4: Testing Only - Mint Test USDT"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u26a0\ufe0f Only for development/testing!"})}),"\n",(0,r.jsx)(e.p,{children:"In your test files, you create a mock USDT mint and mint tokens:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// From tests/devnet-test.ts\nusdtMint = await createMint(\n  provider.connection,\n  user,\n  user.publicKey,  // Mint authority\n  null,\n  USDT_DECIMALS\n);\n\n// Mint USDT to user\nawait mintTo(\n  provider.connection,\n  user,\n  usdtMint,\n  userTokenAccount,\n  user.publicKey,  // Must be mint authority\n  INITIAL_BALANCE\n);\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Note:"})," In production, you cannot mint real USDT - only Tether (the issuer) can mint USDT."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-architecture-why-users-need-usdt-first",children:"\ud83c\udfd7\ufe0f Architecture: Why Users Need USDT First"}),"\n",(0,r.jsx)(e.h3,{id:"your-vault-systems-role",children:"Your Vault System's Role"}),"\n",(0,r.jsxs)(e.p,{children:["Your Collateral Vault system is a ",(0,r.jsx)(e.strong,{children:"custodial vault"}),", not a token provider:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     What Your Vault System Does:       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u2705 Accept deposits of USDT             \u2502\n\u2502 \u2705 Store USDT securely                  \u2502\n\u2502 \u2705 Track balances (total/locked/avail)  \u2502\n\u2502 \u2705 Allow withdrawals                    \u2502\n\u2502 \u2705 Lock/unlock collateral               \u2502\n\u2502                                         \u2502\n\u2502 \u274c Does NOT mint USDT                   \u2502\n\u2502 \u274c Does NOT provide USDT                \u2502\n\u2502 \u274c Does NOT buy USDT for users          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"token-account-creation",children:"Token Account Creation"}),"\n",(0,r.jsxs)(e.p,{children:["When a user first interacts with USDT, their ",(0,r.jsx)(e.strong,{children:"Associated Token Account (ATA)"})," is automatically created:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"User Wallet Address: 7xKt9Fj2...\n    \u2502\n    \u2514\u2500 Associated Token Account (ATA)\n       Address: Derived from (user_wallet, USDT_mint)\n       Balance: 0 USDT initially\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"ATA is created automatically when:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"User swaps SOL \u2192 USDT on a DEX"}),"\n",(0,r.jsx)(e.li,{children:"User receives USDT from another user"}),"\n",(0,r.jsxs)(e.li,{children:["User calls ",(0,r.jsx)(e.code,{children:"getOrCreateAssociatedTokenAccount()"})]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-integration-options-for-your-system",children:"\ud83d\udca1 Integration Options for Your System"}),"\n",(0,r.jsx)(e.h3,{id:"option-a-let-users-handle-it-current-approach",children:"Option A: Let Users Handle It (Current Approach)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u2705 Simple - no additional code needed"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 Users have full control"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 No regulatory concerns about token distribution"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274c Users need to know how to buy USDT"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Extra step for users"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Implementation:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Document how to buy USDT in your UI/docs"}),"\n",(0,r.jsx)(e.li,{children:"Provide links to DEXs"}),"\n",(0,r.jsx)(e.li,{children:"Show wallet balance before allowing deposit"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"option-b-add-dex-integration-advanced",children:"Option B: Add DEX Integration (Advanced)"}),"\n",(0,r.jsx)(e.p,{children:"You could integrate a DEX aggregator API to let users buy USDT directly in your app:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// Example: Integrate Jupiter Swap API\nasync function buyUSDT(userWallet: PublicKey, solAmount: number) {\n  // 1. Get quote from Jupiter\n  const quote = await fetch(\n    `https://quote-api.jup.ag/v6/quote?inputMint=So11111111111111111111111111111111111111112&outputMint=${USDT_MINT}&amount=${solAmount}`\n  );\n  \n  // 2. Build swap transaction\n  const swapTx = await buildSwapTransaction(quote);\n  \n  // 3. User signs and submits\n  // 4. USDT arrives in user's token account\n  // 5. User can now deposit to vault\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u2705 Better UX - one-click buy + deposit"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 Users don't need to leave your app"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274c More complex implementation"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Need to handle swap failures"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Additional fees/risks"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"option-c-provide-test-usdt-faucet-devnet-only",children:"Option C: Provide Test USDT Faucet (Devnet Only)"}),"\n",(0,r.jsx)(e.p,{children:"For testing on devnet, you could create a faucet endpoint:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-rust",children:"// backend/src/api/handlers.rs\npub async fn faucet_usdt(\n    state: web::Data<Arc<AppState>>,\n    body: web::Json<FaucetRequest>,\n) -> HttpResponse {\n    // Only allow on devnet!\n    // Mint test USDT to user's token account\n    // This is ONLY for testing - never on mainnet!\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-current-implementation-details",children:"\ud83d\udcdd Current Implementation Details"}),"\n",(0,r.jsx)(e.h3,{id:"deposit-endpoint-flow",children:"Deposit Endpoint Flow"}),"\n",(0,r.jsxs)(e.p,{children:["Looking at your code (",(0,r.jsx)(e.code,{children:"backend/src/services/transaction_builder.rs"}),"):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-rust",children:"pub async fn build_deposit(\n    &self,\n    user_pubkey: &str,\n    amount: u64,\n) -> Result<String, TransactionBuilderError> {\n    // Gets user's token account\n    let user_token_account = spl_associated_token_account::get_associated_token_address(\n        &user,\n        &self.usdt_mint,\n    );\n    \n    // Gets vault's token account\n    let vault_token_account = spl_associated_token_account::get_associated_token_address(\n        &vault_pda,\n        &self.usdt_mint,\n    );\n    \n    // Builds transfer instruction:\n    // FROM: user_token_account (must have USDT!)\n    // TO: vault_token_account\n    // AUTHORITY: user (signs transaction)\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Key Point:"})," The transaction assumes ",(0,r.jsx)(e.code,{children:"user_token_account"}),' already has USDT. If it doesn\'t, the transaction will fail with "Insufficient funds".']}),"\n",(0,r.jsx)(e.h3,{id:"smart-contract-validation",children:"Smart Contract Validation"}),"\n",(0,r.jsxs)(e.p,{children:["Your smart contract (",(0,r.jsx)(e.code,{children:"programs/collateral-vault/src/instructions/deposit.rs"}),") performs a CPI (Cross-Program Invocation) to the SPL Token Program:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-rust",children:"// This will fail if user_token_account doesn't have enough USDT\ntoken::transfer(cpi_context, amount)?;\n"})}),"\n",(0,r.jsx)(e.p,{children:"The SPL Token Program checks:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.code,{children:"user_token_account"})," exists"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.code,{children:"user_token_account"})," has sufficient balance"]}),"\n",(0,r.jsx)(e.li,{children:"\u2705 User signed the transaction (authority check)"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-recommended-user-flow",children:"\ud83c\udfaf Recommended User Flow"}),"\n",(0,r.jsx)(e.h3,{id:"for-your-frontendui",children:"For Your Frontend/UI:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         User Deposit Flow              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n1. User clicks "Deposit"\n   \u2502\n   \u2193\n2. Check user\'s USDT balance\n   \u2502\n   \u251c\u2500 If balance = 0:\n   \u2502  \u2514\u2500 Show: "You need USDT first!"\n   \u2502     \u2514\u2500 Button: "Buy USDT on Jupiter" (opens DEX)\n   \u2502\n   \u2514\u2500 If balance > 0:\n      \u2514\u2500 Show: "You have X USDT"\n         \u2514\u2500 Allow deposit\n            \u2502\n            \u2193\n3. User enters deposit amount\n   \u2502\n   \u251c\u2500 If amount > balance:\n   \u2502  \u2514\u2500 Error: "Insufficient USDT"\n   \u2502\n   \u2514\u2500 If amount <= balance:\n      \u2514\u2500 Proceed with deposit\n'})}),"\n",(0,r.jsx)(e.h3,{id:"example-frontend-code",children:"Example Frontend Code:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:'async function checkAndDeposit(userPubkey: string, amount: number) {\n  // 1. Check user\'s USDT balance\n  const userTokenAccount = getAssociatedTokenAddressSync(\n    new PublicKey(USDT_MINT),\n    new PublicKey(userPubkey)\n  );\n  \n  const balance = await connection.getTokenAccountBalance(userTokenAccount);\n  \n  if (balance.value.amount === "0") {\n    // Show UI: "You need USDT first! Buy on Jupiter"\n    window.open(`https://jup.ag/swap/SOL-USDT`);\n    return;\n  }\n  \n  if (parseInt(balance.value.amount) < amount) {\n    throw new Error("Insufficient USDT balance");\n  }\n  \n  // 2. Proceed with deposit\n  const depositTx = await fetch("/vault/deposit", {\n    method: "POST",\n    body: JSON.stringify({ userPubkey, amount })\n  });\n  \n  // 3. User signs and submits...\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-checking-users-usdt-balance",children:"\ud83d\udd0d Checking User's USDT Balance"}),"\n",(0,r.jsx)(e.h3,{id:"using-your-backend-api",children:"Using Your Backend API:"}),"\n",(0,r.jsx)(e.p,{children:"You could add an endpoint to check user's USDT balance:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-rust",children:"// backend/src/api/handlers.rs\npub async fn get_user_usdt_balance(\n    state: web::Data<Arc<AppState>>,\n    path: web::Path<String>,\n) -> HttpResponse {\n    let user = path.into_inner();\n    \n    // Get user's token account\n    let user_token_account = get_associated_token_address(\n        &Pubkey::from_str(&user)?,\n        &state.solana.usdt_mint(),\n    );\n    \n    // Check balance\n    let balance = state.solana.get_token_balance(\n        &user_token_account.to_string()\n    ).await?;\n    \n    // Return balance\n    Ok(balance)\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"using-solana-rpc-directly",children:"Using Solana RPC Directly:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:'import { getAssociatedTokenAddressSync, getAccount } from "@solana/spl-token";\n\nconst userTokenAccount = getAssociatedTokenAddressSync(\n  USDT_MINT,\n  userPublicKey\n);\n\nconst accountInfo = await getAccount(connection, userTokenAccount);\nconsole.log("USDT Balance:", accountInfo.amount);\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-summary",children:"\ud83d\udcda Summary"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Question"}),(0,r.jsx)(e.th,{children:"Answer"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Who puts USDT in user's token account?"})}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.strong,{children:"The user themselves"})," (or someone sending them USDT)"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Does your vault provide USDT?"})}),(0,r.jsx)(e.td,{children:"\u274c No - it only manages deposits/withdrawals"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"How do users get USDT?"})}),(0,r.jsx)(e.td,{children:"Buy on DEX (Jupiter, Raydium, Orca), receive from others, or bridge"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"What happens if user has no USDT?"})}),(0,r.jsx)(e.td,{children:'Deposit transaction fails with "Insufficient funds"'})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Can you mint USDT?"})}),(0,r.jsx)(e.td,{children:"\u274c No - only Tether can mint real USDT (test tokens for devnet only)"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-next-steps",children:"\ud83d\ude80 Next Steps"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Document USDT acquisition"})," in your user guide"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Add balance check"})," before allowing deposits"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Consider DEX integration"})," for better UX (optional)"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Add test faucet"})," for devnet testing (optional)"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-useful-links",children:"\ud83d\udd17 Useful Links"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Jupiter Swap"}),": ",(0,r.jsx)(e.a,{href:"https://jup.ag/",children:"https://jup.ag/"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Raydium"}),": ",(0,r.jsx)(e.a,{href:"https://raydium.io/",children:"https://raydium.io/"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Orca"}),": ",(0,r.jsx)(e.a,{href:"https://www.orca.so/",children:"https://www.orca.so/"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"USDT on Solana"}),": ",(0,r.jsx)(e.a,{href:"https://solscan.io/token/Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",children:"https://solscan.io/token/Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"SPL Token Docs"}),": ",(0,r.jsx)(e.a,{href:"https://spl.solana.com/token",children:"https://spl.solana.com/token"})]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Key Takeaway:"})," Your vault is a ",(0,r.jsx)(e.strong,{children:"storage system"}),", not a ",(0,r.jsx)(e.strong,{children:"token provider"}),". Users must acquire USDT through external means (DEX, transfers, bridges) before they can deposit it into your vault."]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>l});var s=t(6540);const r={},o=s.createContext(r);function i(n){const e=s.useContext(o);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);