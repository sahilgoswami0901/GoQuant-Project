# Deploying Rust Documentation

This guide explains how to deploy the Rust documentation generated by `cargo doc` to various platforms.

## Building Documentation

First, generate the documentation:

```bash
cd backend
cargo doc --no-deps --open
```

The documentation will be generated in `target/doc/` directory.

## Deployment Options

### Option 1: GitHub Pages (Recommended for Open Source)

#### Step 1: Build Documentation

```bash
# Build documentation
cargo doc --no-deps

# Copy to docs directory (GitHub Pages serves from /docs)
mkdir -p docs
cp -r target/doc/* docs/
```

#### Step 2: Create GitHub Actions Workflow

Create `.github/workflows/docs.yml`:

```yaml
name: Deploy Documentation

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Install Rust
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
          override: true
      
      - name: Generate Documentation
        run: |
          cd backend
          cargo doc --no-deps
      
      - name: Setup Pages
        uses: actions/configure-pages@v4
      
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: backend/target/doc
      
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

#### Step 3: Enable GitHub Pages

1. Go to your repository Settings â†’ Pages
2. Source: GitHub Actions
3. Save

Your docs will be available at: `https://YOUR_USERNAME.github.io/YOUR_REPO/`

---

### Option 2: Netlify

#### Step 1: Build Script

Create `netlify.toml` in the project root:

```toml
[build]
  command = "cd backend && cargo doc --no-deps"
  publish = "backend/target/doc"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

#### Step 2: Deploy

1. Sign up at [netlify.com](https://netlify.com)
2. Connect your GitHub repository
3. Build command: `cd backend && cargo doc --no-deps`
4. Publish directory: `backend/target/doc`
5. Deploy!

Your docs will be available at: `https://YOUR_SITE.netlify.app`

---

### Option 3: Vercel

#### Step 1: Build Script

Create `vercel.json` in the project root:

```json
{
  "buildCommand": "cd backend && cargo doc --no-deps",
  "outputDirectory": "backend/target/doc",
  "rewrites": [
    { "source": "/(.*)", "destination": "/index.html" }
  ]
}
```

#### Step 2: Deploy

1. Install Vercel CLI: `npm i -g vercel`
2. Run: `vercel`
3. Follow the prompts

Or connect your GitHub repo at [vercel.com](https://vercel.com)

---

### Option 4: Manual Deployment (Any Static Hosting)

#### Step 1: Build and Package

```bash
cd backend
cargo doc --no-deps

# Create a tarball
cd target
tar -czf docs.tar.gz doc/
```

#### Step 2: Upload

Upload the `docs.tar.gz` to your hosting provider and extract it.

---

### Option 5: Local Server (Testing)

For testing locally before deployment:

```bash
cd backend/target/doc
python3 -m http.server 8000
# Or
npx serve .
```

Then visit: `http://localhost:8000`

---

## Custom Domain

To use a custom domain:

1. **GitHub Pages**: Add `CNAME` file in `docs/` directory with your domain
2. **Netlify/Vercel**: Configure custom domain in dashboard settings

---

## Continuous Deployment

The GitHub Actions workflow above will automatically rebuild and deploy documentation whenever you push to the main branch.

---

## Troubleshooting

### Documentation not updating?

- Clear cache: `cargo clean && cargo doc --no-deps`
- Check build logs for errors
- Ensure `target/doc/` contains `index.html`

### Links broken?

- Ensure all relative paths are correct
- Check that JavaScript and CSS files are included
- Use absolute paths if needed

### Build fails?

- Ensure Rust toolchain is installed
- Check that all dependencies compile
- Review `cargo doc` output for errors
